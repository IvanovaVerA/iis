## О чем проект

Проект посвящен решению задачи предсказания классификации цен на мобильные устройства. Ссылка на исходную выборку данных: https://www.kaggle.com/datasets/iabhishekofficial/mobile-price-classification?resource=download

## Запуск

Для запуска проекта необходимо выполнить команды:
```
git clone git@github.com:IvanovaVerA/iis.git
```
или:
```
git clone https://github.com/IvanovaVerA/iis.git
```
переход в папку:
```
cd IIS
```
установка окружения:
```
python -m venv .venv -
```
активация окружения:
```
source .venv/bin/activate
```
установка зависимостей:
```
python -m pip install -r requirements.txt 
```

## Исследование данных

Находится в ./eda/eda.ipynb. Основные результаты:

В ходе исследования были проведены действия:

   - Удалены записи с нулевыми значениями для признаков battery_power, clock_speed, int_memory, m_dep

   - Установлены минимальные значения для размера мобильного устройства: mobile_wt, px_height, px_width

   - Удалены строки, у которых ширина (sc_w) больше высоты (sc_h)



В ходе анализа были выявлены следующие закономерности:

   - Наибольшая корреляция с целевой переменной (price_range) наблюдается у ram (0.92) (см. графики ./eda/CorrelationHeatmap.png и ./eda/ram_vs_price.png)

   - Так же значимыми признаками являются px_height и px_width и была создана новая переменная total_pixels = px_height * px_width (см. график ./eda/new_features.png)

   - имеется положительная линейная зависимость между вуысотой и шириной экрана мобильного устройства

   # Проведение экспериментов по настройке модели.
## Запуск MLFlow

Перейти в директорию mlflow и выполнить скрипт для запуска сервера:

```
cd mlflow
```

```
./run_mlflow.sh
```

## Исследования

Сравнивали между собой модели:

1) Baseline-модель
2) Модель с новыми признаками, полученными с использованием библиотеки sklearn.
3) Модель с наиболее важными признаками, полученными с использованием библиотеки mlxtend.

Для лучшей модели подбирались гиперпараметры с помощью GridSearchCV.

## Результаты исследования

Лучшeй оказалась модель main_features (с отбором наиболее важных признаков) со следующими метриками:

 * recall - 0.9090909090909091
 * precision - 0.9102642811116279
 * f1 - 0.9092405620419367


Лучшиe гиперпараметры:
 * max_depth=None
 * max_features=0.1
 * n_estimators=50

Метрики для данной модели с подобранными гиперпараметрами стали ниже:
* recall - 0.7892561983471075
* precision - 0.7885240640408138
* f1 - 0.7883848892194888


run_id:
```
2c44d7c273684abe8257e246eec8c585
```